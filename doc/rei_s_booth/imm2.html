<html><head>
<title>Input Context - Rei's Booth.</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel=stylesheet href="style.css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#0066cc" vlink="#6b8e23" alink="#ff4500"><center>

<table width=85% border=0 cellspacing=0 cellpadding=0><tr><td>
<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>&gt;
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 3
	</div></font></td>
<td><div align="right"><a href= "imm1.html" ><img src="../../lib/i-prev.png"
	border=0 width=13 height=12 alt="[Previous]"></a>
	<a href= "imm3.html" ><img src="../../lib/i-next.png"
	border=0 width=13 height=12 alt="[Next]"></a>
	<a href= "index.html" ><img src="../../lib/i-up.png"
	border=0 width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png"
	border=0 width=13 height=13 alt="[BBS]"></a></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=2 alt=""></td>
</tr><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr></table><br>

<table width=100% border=0 cellspacing=0 cellpadding=5 bgcolor="#eeeeee"><tr><td class="title">
<font face="arial,helvetica"><b>Input Context</b></font>
</td></tr></table><br>

<font face="arial,helvetica" size=2>

<p>Each window, from the main application window to a control window, has the input context (IMC) against which the IME sends the double-byte (or unicode) characters. Most IMM APIs take the handle to the current IMC as the first parameter.</p>

<p>To retrieve the hIMC, you can use <b>ImmGetContext</b> function. It must be released by <b>ImmReleaseContext</b> function when no longer used.</p>

<p class="sp">&nbsp;</p>

<center><table border=0 cellspacing=0 cellpadding=2 bgcolor="#c0c0c0"><tr><td>
<table border=0 cellspacing=0 cellpadding=8 bgcolor="#f5f5f5"><tr><td><pre>
HIMC hIMC

/* get the hIMC.
   hWnd is the handle to the target window. */
hIMC = ImmGetContext(hWnd);

/* do your process. */
...

/* when you finish using the hIMC,
   you must release it. */
ImmReleaseContext(hWnd, hIMC);
</pre></td></tr></table>
</td></tr></table></center>

<p class="sp">&nbsp;</p>

<table border=0 cellspacing=0 cellpadding=0><tr valign="top">
<td><font face="verdana,arial,helvetica" class="ss"><b>Note</b></font></td>
<td><img src="../../lib/trans.png" width=8 height=1 alt=":"></td>
<td><font face="arial,helvetica" size=2><div><b>ImmGetContext</b> can not retrieve the hIMC for the window belonged to the other process.</div></font></td>
</tr></table><br>

<p>You can also create a new hIMC and associate it with a window. To do this, first create a hIMC using <b>ImmCreateContext</b>. Next, use <b>ImmAssociateContext</b> to associate the specified hIMC with the specified window. It returns the previous hIMC for the window. You can even disable the current IME using this API passing NULL instead of a context to be associated. (See the <a href= "imm3.html" >next topic</a> for more information.)</div></p>

<p>If the new hIMC is not needed any longer after some operation, you should restore the previous hIMC and destroy the one you've created by <b>ImmDestroyContext</b>.</p>

</font>
<p class="sp">&nbsp;</p>

<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=3 alt=""></td>
</tr><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>&gt;
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 3
	</div></font></td>
<td><div align="right"><a href= "imm1.html" ><img src="../../lib/i-prev.png"
	border=0 width=13 height=12 alt="[Previous]"></a>
	<a href= "imm3.html" ><img src="../../lib/i-next.png"
	border=0 width=13 height=12 alt="[Next]"></a>
	<a href= "index.html" ><img src="../../lib/i-up.png"
	border=0 width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png"
	border=0 width=13 height=13 alt="[BBS]"></a></td>
</tr></table>
</td></tr></table>

</center></body></html>
