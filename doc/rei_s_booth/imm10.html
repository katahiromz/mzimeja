<html><head>
<title>Invoking IME Dialog - Rei's Booth.</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel=stylesheet href="style.css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#0066cc" vlink="#6b8e23" alink="#ff4500"><center>

<table width=85% border=0 cellspacing=0 cellpadding=0><tr><td>
<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>:
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 11
	</div></font></td>
<td nowrap><div align="right">
	<a href= "imm9.html" ><img src="../../lib/i-prev.png"
	border=0 width=13 height=12 alt="[Previous]"></a>
	<a href= "imm11.html" ><img src="../../lib/i-next.png"
	border=0 width=13 height=12 alt="[Next]"></a>
	<a href= "index.html" ><img src="../../lib/i-up.png"
	border=0 width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png" border=0 width=13 height=13 alt="[BBS]"></a>
	</div></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=2></td>
</tr><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr></table><br>

<table width=100% border=0 cellspacing=0 cellpadding=5 bgcolor="#eeeeee"><tr><td class="title">
<font face="arial,helvetica"><b>Invoking IME Dialog</b></font>
</td></tr></table><br>

<font face="arial,helvetica" size=2>

<p>Some application may open the property dialog or the word registration dialog of the IME. Microsoft Word is a good example for this. IMM enables an application to open an IME dialog which is to configure the IME, register a word or to select dictionaries. It can be done by one function, <b>ImmConfigureIME</b>.</p>

<p>Displaying IME's property dialog is quite easy as follows:</p>

<p class="sp">&nbsp;</p>

<blockquote><table border=0 cellspacing=0 cellpadding=2 bgcolor="#c0c0c0"><tr><td>
<table border=0 cellspacing=0 cellpadding=5 bgcolor="#f5f5f5"><tr><td><pre>
 HKL hKL;

 if ((hKL = GetKeyboardLayout(0)) != NULL) {
     ImmConfigureIME(hKL, hWnd, IME_CONFIG_GENERAL, NULL);&nbsp;
 }
</pre></td></tr></table>
</td></tr></table></blockquote>

<p class="sp">&nbsp;</p>

<p>To open the dictionary selection dialog, use <b>IME_CONFIG_SELECTDICTIONARY</b> value instead of <b>IME_CONFIG_GENERAL</b>.</p>

<p>And using <b>IME_CONFIG_REGISTERWORD</b> value will invokes the word registration dialog. You can supply the reading and/or the word to be registered if you want. In this case, the IME will initialize its dialog with the data passed by the application.</p>

<p class="sp">&nbsp;</p>

<blockquote><table border=0 cellspacing=0 cellpadding=2 bgcolor="#c0c0c0"><tr><td>
<table border=0 cellspacing=0 cellpadding=5 bgcolor="#f5f5f5"><tr><td><pre>
 HKL hKL;

 if ((hKL = GetLeyboardLayout(0)) != NULL) {
     REGISTERWORD rw;

     rw.lpReading = NULL;
     rw.lpWord = _T("Test");

     ImmConfigureIME(hKL, hWnd,
             IME_CONFIG_REGISTERWORD, (LPVOID)&rw);&nbsp;
     /* if no reading/word information is needed,
        you can set NULL to the 4th parameter. */
 }
</pre></td></tr></table>
</td></tr></table></blockquote>

<p class="sp">&nbsp;</p>

<p>The IME dialog may be shown modally and <b>ImmConfigureIME</b> won't return until it is closed in this case.</p>

</font>
<p class="sp">&nbsp;</p>

<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=3 alt=""></td>
</tr><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>:
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 11
	</div></font></td>
<td><div align="right">
	<a href= "imm9.html" ><img src="../../lib/i-prev.png" border=0
	width=13 height=12 alt="[Previous]"></a>
	<a href= "imm11.html" ><img src="../../lib/i-next.png" border=0
	width=13 height=12 alt="[Next]"></a>
	<a href= "index.html" ><img src="../../lib/i-up.png" border=0
	width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png" border=0 width=13 height=13 alt="[BBS]"></a>
	</div></td>
</tr></table>
</td></tr></table>

</center></body></html>
