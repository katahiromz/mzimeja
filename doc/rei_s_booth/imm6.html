<html><head>
<title>Conversion - Rei's Booth.</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel=stylesheet href="style.css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#0066cc" vlink="#6b8e23" alink="#ff4500"><center>

<table width=85% border=0 cellspacing=0 cellpadding=0><tr><td>
<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>:
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 7
	</div></font></td>
<td nowrap><div align="right">
	<a href= "imm5.html" ><img src="../../lib/i-prev.png"
	border=0 width=13 height=12 alt="[Previous]"></a>
	<a href= "imm7.html" ><img src="../../lib/i-next.png"
	border=0 width=13 height=12 alt="[Next]"></a>
	<a href= "index.html" ><img src="../../lib/i-up.png"
	border=0 width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png" border=0 width=13 height=13 alt="[BBS]"></a>
	</div></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=2></td>
</tr><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr></table><br>

<table width=100% border=0 cellspacing=0 cellpadding=5 bgcolor="#eeeeee"><tr><td class="title">
<font face="arial,helvetica"><b>Conversion</b></font>
</td></tr></table><br>

<font face="arial,helvetica" size=2>

<p>Because the purpose of an IME is to input the local string, it is essential process to convert the reading string into the &quot;<i>Result String</i>&quot;, which in Japanese case will be kanji-mixed string.</p>

<p>Usually the user presses conversion key (Space key) to convert the string and select an appropriate candidate, and then Enter key to determine it. The <a href= "imm5.html" >composition string</a> changes according to the user's operation and a <a href= "imm7.html" >candidate window</a> may be opened and closed when needed. The application window will receive the corresponding notification messages from the IME.</p>

<p>Now you may want to know the answer to:</p>

<blockquote><img src="../img/faq.png" width=24 height=16 alt="faQ:">
<u>How to convert, revert, complete or cancel the composition string programmably?</u></blockquote>

<p>That's quite easy... use <b>ImmNotifyIME</b> API with <b>NI_COMPOSITIONSTR</b> value. The function make the IME change the current composition string. The conversion to be taken is decided by the value of the 3rd parameter, <b>CPS_CONVERT</b>, <b>CPS_REVERT</b>, <b>CPS_COMPLETE</b> or <b>CPS_CANCEL</b>.<br>
If there is no composition string, normally the IME does nothing.</p>

<p class="sp">&nbsp;</p>

<blockquote><table border=0 cellspacing=0 cellpadding=2 bgcolor="#c0c0c0"><tr><td>
<table border=0 cellspacing=0 cellpadding=5 bgcolor="#f5f5f5"><tr><td><pre>
 HIMC hIMC;
 TCHAR szCompStr[BUFFER_SIZE];
 LONG len;

 if ((hIMC = ImmGetContext(hWnd)) != NULL) {
     /* get the current composition string. */
     len = ImmGetCompositionString(hIMC, GCS_COMPSTR,
         (LPVOID)szCompStr, sizeof(szCompStr));

     /* convert. */
     ImmNotifyIME(hIMC, NI_COMPOSITIONSTR, CPS_CONVERT, 0);&nbsp;
     /* revert. */
     ImmNotifyIME(hIMC, NI_COMPOSITIONSTR, CPS_REVERT, 0);
     /* cancel. */
     ImmNotifyIME(hIMC, NI_COMPOSITIONSTR, CPS_CANCEL, 0);

     /* set the composition string again. */
     ImmSetCompositionString(hIMC, SCS_SETSTR,
             (LPCVOID)szCompStr, len, NULL, 0);

     /* convert again. */
     ImmNotifyIME(hIMC, NI_COMPOSITIONSTR, CPS_CONVERT, 0);
     /* complete the string. */
     ImmNotifyIME(hIMC, NI_COMPOSITIONSTR, CPS_COMPLETE, 0);&nbsp;

     ImmReleaseContext(hWnd, hIMC);
 }
</pre></td></tr></table>
</td></tr></table></blockquote>

<p class="sp">&nbsp;</p>

<table border=0 cellspacing=0 cellpadding=0><tr valign="top">
<td><font face="verdana,arial,helvetica" class="ss"><b>Note</b></font></td>
<td><img src="../../lib/trans.png" width=8 height=1 alt=":"></td>
<td><font face="arial,helvetica" size=2><div>Someone may try to use <b>ImmGetConversionList</b> to retrieve the candidates for a certain string. However, currently there are few IMEs which respond to this API call properly (in Japan). Now, MSKK's MS-IME 98 and MS-IME 2000 should have supprted it. However, you will not able to get an expected result unless you specify a 'valid' reading string, which consists of hiragana characters.</div></font></td>
</tr></table>

</font>
<p class="sp">&nbsp;</p>

<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=3 alt=""></td>
</tr><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>:
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 7
	</div></font></td>
<td><div align="right">
	<a href= "imm5.html" ><img src="../../lib/i-prev.png" border=0
	width=13 height=12 alt="[Previous]"></a>
	<a href= "imm7.html" ><img src="../../lib/i-next.png" border=0
	width=13 height=12 alt="[Next]"></a>
	<a href= "index.html" ><img src="../../lib/i-up.png" border=0
	width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png" border=0
	width=13 height=13 alt="[BBS]"></div></td>
</tr></table>
</td></tr></table>

</center></basefont></body></html>
