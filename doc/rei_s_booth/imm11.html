<html><head>
<title>Handling User Dictionary - Rei's Booth.</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel=stylesheet href="style.css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#0066cc" vlink="#6b8e23" alink="#ff4500"><center>

<table width=85% border=0 cellspacing=0 cellpadding=0><tr><td>
<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="this" href= "index__2.html" ><b>Design</b></a>:
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 12
	</div></font></td>
<td nowrap><div align="right">
	<a href= "imm10.html" ><img src="../../lib/i-prev.png"
	border=0 width=13 height=12 alt="[Previous]"></a>
	<img src="../../lib/d-next.png" width=13 height=12 alt="">
	<a href= "index.html" ><img src="../../lib/i-up.png"
	border=0 width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png" border=0 width=13 height=13 alt="[BBS]"></a>
	</div></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=2></td>
</tr><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr></table><br>

<table width=100% border=0 cellspacing=0 cellpadding=5 bgcolor="#eeeeee"><tr><td class="title">
<font face="arial,helvetica"><b>Handling User Dictionary</b></font>
</td></tr></table><br>

<font face="arial,helvetica" size=2>

<p>One way to register a word into the IME's dictionary is to use <b>ImmConfigureIME</b> as described in the <a href= "imm10.html"  title="Invoking an IME Dialog">Section 10</a>. But this API always displays a modal dialog managed by the IME.<br>
If you want to register a word (or words) fully programmably, that is, without displaying any IME dialog boxes nor messages, you should desin another routine.</p>

<p>IMM provides a function to realize our purpose: <b>ImmRegisterWord</b>. It takes 4 parameters; a handle to the keyboard layout, the reading string, the part of speech and the word.<br>
The values defined to describe the part of speeches differ with the IME. You can retrieve the definition by <b>ImmGetRegisterWordStyle</b> API.</p>

<p class="sp">&nbsp;</p>

<blockquote><table border=0 cellspacing=0 cellpadding=2 bgcolor="#c0c0c0"><tr><td>
<table border=0 cellspacing=0 cellpadding=5 bgcolor="#f5f5f5"><tr><td><pre>
 HKL hKL;
 TCHAR szRead[8];           /* reading string to register. */
 LPSTYLEBUF lpStyleBuf;     /* buffer for POS. */
 UINT nPos, i;

 hKL = GetKeyboardLayout(0);

 /* allocate the buffer to store the POS information. */&nbsp;
 nPos = ImmGetRegisterWordStyle(hKL, 0, NULL);
 if (!(lpStyleBuf = (LPSTYLEBUF)
         GlobalAllocPtr(GHND, sizeof(STYLEBUF) * nPos))) {&nbsp;
     /* not enough memory. */
     return;
 }

 /* get POS information of current IME. */
 ImmGetRegisterWordStyle(hKL, nPos, lpStyleBuf);

 /* this is just a test routine. */
 for (i = 0; i < nPos; i++) {
     wsprintf(szRead, _T("POS%d"), i);
     ImmRegisterWordStyle(hKL,
         szRead,                            /* reading. */
         (lpStyleBuf + i)->dwStyle,         /* POS. */
         (lpStyleBuf + i)->szDescription    /* word. */
     );
 }

 GlobalFreePtr(lpStyleBuf);
</pre></td></tr></table>
</td></tr></table></blockquote>

<p class="sp">&nbsp;</p>

<p>If you are to delete a specified word from the dictionary, use <b>ImmUnregisterWord</b>. This function takes the same parameters as <b>ImmRegisterWord</b>, but it works in an opposite way.</p>

<p>You can even enumerate all the words registered in the IME's user dictionary by <b>ImmEnumRegisterWord</b>. The IME will call the application-defined callback function for each word with its reading, word string and POS information.</p>

<p>So, using these APIs, you can create a dictionary tool which can work with most IMEs desined along the IME specification for Win95/NT4. Here is a sample program of this kind, <a href= "imedic.html" >IMEDic Sample</a>, which enables you to edit the IME's user dictionary.</p>

</font>
<p class="sp">&nbsp;</p>

<table width=100% border=0 cellspacing=0 cellpadding=0><tr>
<td colspan=2 bgcolor="#c0c0c0"><center><img src="../../lib/trans.png" width=1 height=2 alt="- - - - - - - - - - - - - - - - - - - -"></center></td>
</tr><tr>
<td colspan=2><img src="../../lib/trans.png" width=1 height=3 alt=""></td>
</tr><tr>
<td><font face="verdana,arial,helvetica" size=1 color="#666666">
	<div class="ss"><a class="nav" href= "index__2.html" >Design</a>:
	<a class="nav" href= "index.html" >IMM Programming Tutorial</a>: 12
	</div></font></td>
<td><div align="right">
	<a href= "imm10.html" ><img src="../../lib/i-prev.png" border=0
	width=13 height=12 alt="[Previous]"></a>
	<img src="../../lib/d-next.png" width=13 height=12 alt="">
	<a href= "index.html" ><img src="../../lib/i-up.png" border=0
	width=13 height=13 alt="[Up]"></a>
	<a href= "index__1.html" ><img src="../../lib/i-home.png"
	border=0 width=13 height=13 alt="[Home]"></a>
	<a href="http://thunder.prohosting.com/~reis/cgi-bin/reisbooth.cgi"><img src="../../lib/i-bbs.png" border=0 width=13 height=13 alt="[BBS]"></a>
	</div></td>
</tr></table>
</td></tr></table>

</center></body></html>
